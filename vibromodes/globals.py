import numpy as np
from vibromodes.utils import convert_1d_to_interpolator
import torch

AMPLITUDE_STD = 4.7062
FRF_STD = 7.0445

LINEAR_FIELD_STD = 0.0048118

AMPLITUDE_MEANS = np.array([-25.1376, -24.1359, -23.4986, -23.0272, -22.6516, -22.3384, -22.0691,
        -21.8323, -21.6205, -21.4285, -21.2525, -21.0896, -20.9378, -20.7953,
        -20.6607, -20.5329, -20.4111, -20.2943, -20.1821, -20.0737, -19.9688,
        -19.8670, -19.7677, -19.6708, -19.5759, -19.4827, -19.3910, -19.3004,
        -19.2109, -19.1221, -19.0337, -18.9455, -18.8572, -18.7681, -18.6774,
        -18.5820, -18.4962, -18.4131, -18.3232, -18.2320, -18.1422, -18.0507,
        -17.9709, -17.8802, -17.7854, -17.6839, -17.5785, -17.4847, -17.3962,
        -17.3058, -17.2173, -17.1335, -17.0423, -16.9427, -16.8452, -16.7571,
        -16.6686, -16.5792, -16.4882, -16.4035, -16.3179, -16.2454, -16.1888,
        -16.1259, -16.0655, -15.9849, -15.9084, -15.8545, -15.7782, -15.6927,
        -15.6191, -15.5455, -15.4715, -15.3943, -15.3211, -15.2481, -15.1779,
        -15.0918, -15.0095, -14.9593, -14.9143, -14.8585, -14.7791, -14.6737,
        -14.5658, -14.4901, -14.4292, -14.3805, -14.3535, -14.3291, -14.2981,
        -14.2767, -14.2646, -14.2525, -14.2485, -14.2455, -14.2487, -14.2557,
        -14.2604, -14.2791, -14.3131, -14.3463, -14.3703, -14.3940, -14.4225,
        -14.4502, -14.4760, -14.5098, -14.5545, -14.6057, -14.6642, -14.7352,
        -14.8097, -14.8654, -14.9070, -14.9401, -14.9740, -15.0072, -15.0310,
        -15.0434, -15.0368, -15.0205, -15.0100, -15.0080, -15.0039, -15.0011,
        -14.9943, -14.9939, -15.0041, -15.0111, -15.0067, -14.9980, -14.9927,
        -14.9894, -14.9868, -14.9768, -14.9645, -14.9538, -14.9451, -14.9439,
        -14.9428, -14.9379, -14.9343, -14.9363, -14.9369, -14.9326, -14.9182,
        -14.8972, -14.8713, -14.8402, -14.8138, -14.7899, -14.7634, -14.7342,
        -14.7057, -14.6713, -14.6406, -14.6144, -14.5912, -14.5811, -14.5803,
        -14.5894, -14.6030, -14.6164, -14.6234, -14.6277, -14.6260, -14.6176,
        -14.6061, -14.5994, -14.5972, -14.5936, -14.5833, -14.5645, -14.5425,
        -14.5255, -14.5179, -14.5182, -14.5185, -14.5122, -14.5006, -14.4859,
        -14.4744, -14.4733, -14.4771, -14.4828, -14.4920, -14.5022, -14.5128,
        -14.5213, -14.5303, -14.5427, -14.5572, -14.5733, -14.5899, -14.6101,
        -14.6361, -14.6607, -14.6791, -14.6905, -14.6962, -14.6972, -14.6945,
        -14.6900, -14.6874, -14.6864, -14.6870, -14.6855, -14.6800, -14.6702,
        -14.6586, -14.6454, -14.6308, -14.6170, -14.6053, -14.5966, -14.5940,
        -14.6007, -14.6141, -14.6299, -14.6466, -14.6679, -14.6903, -14.7113,
        -14.7273, -14.7384, -14.7466, -14.7515, -14.7514, -14.7471, -14.7410,
        -14.7363, -14.7361, -14.7376, -14.7347, -14.7279, -14.7165, -14.7066,
        -14.6979, -14.6920, -14.6914, -14.6920, -14.6937, -14.6982, -14.7050,
        -14.7095, -14.7077, -14.7035, -14.7025, -14.7063, -14.7138, -14.7226,
        -14.7290, -14.7319, -14.7320, -14.7321, -14.7349, -14.7439, -14.7558,
        -14.7645, -14.7675, -14.7670, -14.7686, -14.7724, -14.7777, -14.7825,
        -14.7866, -14.7873, -14.7863, -14.7856, -14.7847, -14.7813, -14.7732,
        -14.7650, -14.7588, -14.7581, -14.7634, -14.7735, -14.7848, -14.7935,
        -14.7966, -14.7968, -14.7956, -14.7936, -14.7922, -14.7922, -14.7929,
        -14.7956, -14.7974, -14.7976, -14.7935, -14.7843, -14.7718, -14.7586,
        -14.7478, -14.7385, -14.7303, -14.7225, -14.7129, -14.7038])


_LINEAR_FIELD_STDS_PER_FREQ = torch.tensor(
       [1.6189e-05, 3.2458e-05, 4.8886e-05, 6.5559e-05, 8.2565e-05, 1.0000e-04,
        1.1798e-04, 1.3661e-04, 1.5604e-04, 1.7642e-04, 1.9795e-04, 2.2084e-04,
        2.4537e-04, 2.7187e-04, 3.0075e-04, 3.3256e-04, 3.6798e-04, 4.0792e-04,
        4.5363e-04, 5.0687e-04, 5.7014e-04, 6.4725e-04, 7.4423e-04, 8.7140e-04,
        1.0478e-03, 1.3133e-03, 1.7694e-03, 2.7718e-03, 6.8205e-03, 7.8692e-03,
        1.0569e-02, 4.8125e-03, 8.0924e-03, 1.0053e-02, 4.6935e-03, 5.7385e-03,
        3.1953e-03, 3.6948e-03, 7.7689e-03, 1.1100e-02, 5.9419e-03, 4.6589e-03,
        9.0959e-03, 4.7602e-03, 3.2810e-03, 3.7864e-03, 5.6113e-03, 7.8883e-03,
        6.6878e-03, 7.4938e-03, 8.3425e-03, 7.1453e-03, 4.1781e-03, 3.9443e-03,
        5.2442e-03, 3.6217e-03, 4.6606e-03, 7.5333e-03, 4.8628e-03, 6.4657e-03,
        4.5662e-03, 5.1872e-03, 6.4927e-03, 5.5439e-03, 5.5522e-03, 7.5862e-03,
        1.0598e-02, 1.0260e-02, 8.6654e-03, 8.1639e-03, 9.2618e-03, 7.2630e-03,
        8.0758e-03, 7.2060e-03, 9.4003e-03, 1.0000e-02, 1.0011e-02, 1.0470e-02,
        9.8248e-03, 8.6454e-03, 7.6494e-03, 8.4465e-03, 7.2649e-03, 6.3709e-03,
        6.0221e-03, 6.7744e-03, 6.1862e-03, 4.7862e-03, 5.1000e-03, 4.8892e-03,
        4.7426e-03, 5.8451e-03, 6.8523e-03, 6.6200e-03, 5.5730e-03, 5.5906e-03,
        4.8341e-03, 3.8955e-03, 4.1997e-03, 5.4047e-03, 6.1828e-03, 4.8123e-03,
        3.7708e-03, 3.7860e-03, 4.7818e-03, 5.9180e-03, 4.8500e-03, 4.6730e-03,
        5.7217e-03, 6.3007e-03, 5.9769e-03, 5.3108e-03, 4.8786e-03, 4.8170e-03,
        5.2036e-03, 5.5243e-03, 5.7388e-03, 4.8779e-03, 4.1521e-03, 4.0003e-03,
        3.9532e-03, 4.6092e-03, 5.2589e-03, 5.6759e-03, 6.1524e-03, 5.8019e-03,
        5.3015e-03, 4.7259e-03, 4.0278e-03, 3.7521e-03, 4.0420e-03, 4.0232e-03,
        3.8403e-03, 4.1997e-03, 4.5259e-03, 4.1944e-03, 4.2421e-03, 4.7046e-03,
        4.3828e-03, 4.1179e-03, 4.0862e-03, 3.7935e-03, 3.8718e-03, 4.3615e-03,
        4.8036e-03, 4.7989e-03, 4.9132e-03, 5.1944e-03, 5.5838e-03, 5.1650e-03,
        4.5762e-03, 4.4498e-03, 4.3704e-03, 4.2967e-03, 4.5006e-03, 4.8010e-03,
        4.8468e-03, 5.2089e-03, 5.9135e-03, 5.8198e-03, 5.2396e-03, 5.0052e-03,
        4.8175e-03, 4.7465e-03, 4.8704e-03, 4.9811e-03, 5.0571e-03, 4.9653e-03,
        4.5783e-03, 4.2843e-03, 4.3424e-03, 4.6554e-03, 4.8813e-03, 5.0874e-03,
        4.8227e-03, 4.0394e-03, 3.3744e-03, 2.9836e-03, 2.8342e-03, 2.9089e-03,
        3.1588e-03, 3.4338e-03, 3.6821e-03, 3.8136e-03, 3.6445e-03, 3.4143e-03,
        3.3165e-03, 3.3288e-03, 3.4676e-03, 3.5293e-03, 3.4691e-03, 3.3278e-03,
        3.2007e-03, 3.0507e-03, 3.0207e-03, 3.2097e-03, 3.5007e-03, 3.8719e-03,
        4.3009e-03, 4.5776e-03, 4.5169e-03, 4.1986e-03, 3.7537e-03, 3.4238e-03,
        3.3607e-03, 3.4471e-03, 3.5036e-03, 3.5218e-03, 3.4890e-03, 3.3788e-03,
        3.3116e-03, 3.3368e-03, 3.3508e-03, 3.4597e-03, 3.6776e-03, 3.7451e-03,
        3.6019e-03, 3.3279e-03, 3.0185e-03, 2.8440e-03, 2.8320e-03, 2.8724e-03,
        2.8644e-03, 2.8655e-03, 2.8923e-03, 2.9385e-03, 3.0153e-03, 3.1244e-03,
        3.3309e-03, 3.6066e-03, 3.7430e-03, 3.7110e-03, 3.5489e-03, 3.2853e-03,
        3.0297e-03, 2.8696e-03, 2.8250e-03, 2.8849e-03, 3.0540e-03, 3.2695e-03,
        3.4400e-03, 3.5136e-03, 3.5511e-03, 3.6115e-03, 3.5028e-03, 3.3353e-03,
        3.1552e-03, 3.0892e-03, 3.1787e-03, 3.3876e-03, 3.5721e-03, 3.6144e-03,
        3.5244e-03, 3.3744e-03, 3.2900e-03, 3.2823e-03, 3.3611e-03, 3.5102e-03,
        3.6122e-03, 3.6397e-03, 3.6382e-03, 3.6303e-03, 3.6244e-03, 3.6444e-03,
        3.6557e-03, 3.5651e-03, 3.3281e-03, 3.0975e-03, 2.9626e-03, 2.9264e-03,
        2.9258e-03, 2.9241e-03, 2.9286e-03, 2.9806e-03, 3.0732e-03, 3.1903e-03,
        3.2589e-03, 3.2392e-03, 3.2118e-03, 3.2415e-03, 3.3148e-03, 3.4233e-03,
        3.5496e-03, 3.6828e-03, 3.8235e-03, 3.9153e-03, 3.8724e-03, 3.6307e-03,
        3.2899e-03, 2.9922e-03, 2.7796e-03, 2.6353e-03, 2.5721e-03, 2.6011e-03,
        2.7139e-03, 2.8386e-03, 2.8959e-03, 2.8398e-03, 2.7529e-03, 2.6989e-03]
)

#filtered with gaussian kernel of sigma 10
_LINEAR_FIELD_STDS_PER_FREQ = torch.tensor(
       [0.00021388, 0.00021952, 0.00023108, 0.00024873, 0.00027281,
       0.00030381, 0.0003424 , 0.00038922, 0.00044509, 0.00051085,
       0.00058725, 0.0006752 , 0.00077544, 0.00088871, 0.00101555,
       0.00115631, 0.00131118, 0.0014801 , 0.00166264, 0.00185814,
       0.00206555, 0.00228355, 0.00251049, 0.00274443, 0.00298319,
       0.00322445, 0.00346576, 0.00370459, 0.00393843, 0.00416494,
       0.00438193, 0.00458741, 0.00477978, 0.00495769, 0.00512024,
       0.00526685, 0.00539732, 0.00551184, 0.00561091, 0.00569537,
       0.00576629, 0.00582501, 0.00587302, 0.00591196, 0.00594355,
       0.0059696 , 0.00599189, 0.00601219, 0.00603226, 0.00605373,
       0.00607813, 0.00610686, 0.00614113, 0.00618196, 0.00623009,
       0.00628607, 0.00635013, 0.00642222, 0.00650199, 0.0065888 ,
       0.00668171, 0.00677944, 0.00688052, 0.00698325, 0.00708577,
       0.00718608, 0.00728209, 0.00737174, 0.00745304, 0.00752408,
       0.00758317, 0.00762881, 0.00765988, 0.00767538, 0.00767479,
       0.00765797, 0.00762499, 0.00757636, 0.00751285, 0.00743555,
       0.00734583, 0.00724534, 0.00713575, 0.00701882, 0.00689652,
       0.00677067, 0.00664308, 0.00651545, 0.00638938, 0.00626635,
       0.0061476 , 0.00603419, 0.005927  , 0.00582671, 0.00573375,
       0.00564838, 0.00557074, 0.00550076, 0.00543821, 0.00538283,
       0.00533416, 0.0052917 , 0.00525486, 0.00522299, 0.00519545,
       0.00517155, 0.00515058, 0.00513186, 0.00511481, 0.0050988 ,
       0.00508328, 0.00506772, 0.00505174, 0.00503494, 0.00501705,
       0.00499783, 0.00497715, 0.00495495, 0.00493121, 0.00490601,
       0.00487944, 0.0048517 , 0.00482298, 0.00479358, 0.00476384,
       0.0047341 , 0.00470473, 0.00467618, 0.00464885, 0.00462315,
       0.00459949, 0.00457828, 0.00455983, 0.00454446, 0.00453242,
       0.00452389, 0.00451894, 0.00451763, 0.00451988, 0.00452557,
       0.00453449, 0.00454637, 0.00456092, 0.00457775, 0.00459641,
       0.00461645, 0.0046374 , 0.00465879, 0.00468011, 0.00470085,
       0.00472052, 0.00473865, 0.00475477, 0.00476842, 0.00477917,
       0.00478662, 0.0047904 , 0.00479018, 0.00478568, 0.00477666,
       0.00476292, 0.00474433, 0.00472083, 0.00469243, 0.00465922,
       0.0046214 , 0.0045792 , 0.00453298, 0.00448313, 0.00443014,
       0.00437455, 0.00431696, 0.00425802, 0.00419839, 0.00413875,
       0.0040798 , 0.00402219, 0.00396655, 0.00391345, 0.00386341,
       0.00381688, 0.00377421, 0.00373567, 0.00370143, 0.00367158,
       0.00364608, 0.00362485, 0.00360768, 0.0035943 , 0.00358436,
       0.00357746, 0.00357315, 0.00357094, 0.00357032, 0.00357076,
       0.00357176, 0.00357282, 0.0035735 , 0.00357338, 0.0035721 ,
       0.00356936, 0.00356494, 0.00355867, 0.00355045, 0.00354026,
       0.00352814, 0.0035142 , 0.00349859, 0.00348153, 0.00346327,
       0.00344409, 0.00342427, 0.00340412, 0.00338397, 0.0033641 ,
       0.00334484, 0.00332644, 0.00330916, 0.00329321, 0.00327877,
       0.00326597, 0.0032549 , 0.00324564, 0.00323819, 0.00323253,
       0.00322862, 0.00322637, 0.00322567, 0.00322639, 0.00322841,
       0.00323159, 0.00323579, 0.00324088, 0.00324674, 0.00325325,
       0.00326031, 0.00326783, 0.00327572, 0.00328392, 0.00329236,
       0.00330096, 0.00330968, 0.00331844, 0.00332718, 0.0033358 ,
       0.00334423, 0.00335236, 0.00336008, 0.00336728, 0.00337385,
       0.00337966, 0.0033846 , 0.00338855, 0.00339139, 0.00339306,
       0.00339346, 0.00339257, 0.00339036, 0.00338687, 0.00338214,
       0.00337626, 0.00336938, 0.00336165, 0.00335326, 0.00334442,
       0.00333535, 0.00332627, 0.00331738, 0.00330887, 0.00330087,
       0.00329349, 0.00328676, 0.00328069, 0.00327519, 0.00327013,
       0.00326533, 0.00326055, 0.00325553, 0.00325   , 0.00324368,
       0.00323631, 0.00322767, 0.00321759, 0.00320594, 0.00319269,
       0.00317788, 0.00316161, 0.00314409, 0.00312559, 0.00310645,
       0.00308704, 0.00306781, 0.00304921, 0.00303169, 0.00301571,
       0.00300168, 0.00298996, 0.00298088, 0.00297469, 0.00297155]
)

LINEAR_FIELD_STDS_PER_FREQ = convert_1d_to_interpolator(_LINEAR_FIELD_STDS_PER_FREQ,0,300)